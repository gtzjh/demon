<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <div class="container">
    <a class="navbar-brand" href="index.html">EASE</a>
    <button class="navbar-toggler collapsed" type="button" 
            data-bs-toggle="collapse" 
            data-bs-target="#navbarNav" 
            aria-controls="navbarNav" 
            aria-expanded="false" 
            aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    
    <!-- 添加 collapse show 类来确保正确的初始状态 -->
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
        <li class="nav-item"><a class="nav-link" href="people.html">People</a></li>
        <li class="nav-item"><a class="nav-link" href="news.html">News</a></li>
        <li class="nav-item"><a class="nav-link" href="projects.html">Projects</a></li>
        <li class="nav-item"><a class="nav-link" href="data.html">Data</a></li>
        <li class="nav-item"><a class="nav-link" href="publications.html">Publications</a></li>
        <li class="nav-item"><a class="nav-link" href="opportunities.html">Opportunities</a></li>
      </ul>
      <!-- 添加搜索图标和搜索框 -->
      <div class="ms-3">
        <div class="input-group">
          <input type="text" id="global-search" class="form-control" 
                 placeholder="Search..." aria-label="Search">
        </div>
        <div id="search-results" class="dropdown-menu" 
             style="width: 300px; max-height: 400px; overflow-y: auto;"></div>
      </div>
    </div>
  </div>
</nav>

<!-- 将Bootstrap的JS文件移到body最后，并确保jQuery也被加载 -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js"></script>
<script src="/js/search.js"></script>

<!-- 在底部添加初始化代码 -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  // 获取所有dropdown触发器
  var dropdowns = document.querySelectorAll('.dropdown-toggle');
  
  dropdowns.forEach(function(dropdown) {
    dropdown.addEventListener('click', function(e) {
      // 如果在移动视图中
      if (window.innerWidth < 992) {
        e.preventDefault();
        e.stopPropagation();
        
        // 切换当前下拉菜单
        var dropdownMenu = this.nextElementSibling;
        var isOpen = dropdownMenu.classList.contains('show');
        
        // 关闭所有其他打开的下拉菜单
        document.querySelectorAll('.dropdown-menu.show').forEach(function(menu) {
          if (menu !== dropdownMenu) {
            menu.classList.remove('show');
            menu.previousElementSibling.setAttribute('aria-expanded', 'false');
          }
        });
        
        // 切换当前菜单
        dropdownMenu.classList.toggle('show');
        this.setAttribute('aria-expanded', !isOpen);
      }
    });
  });
  
  // 点击外部关闭下拉菜单
  document.addEventListener('click', function(e) {
    if (!e.target.closest('.dropdown')) {
      document.querySelectorAll('.dropdown-menu.show').forEach(function(menu) {
        menu.classList.remove('show');
        menu.previousElementSibling.setAttribute('aria-expanded', 'false');
      });
    }
  });
});
</script>